<template>
  <require from="common/custom-select/custom-select"></require>
  <require from="common/modal/modal"></require>
  <require from="common/modal/modal-header"></require>
  <require from="common/modal/modal-body"></require>
  <require from="common/modal/modal-footer"></require>

  <div class="container">
    <div class="well well-sm bg-purple header"><h3>Instances</h3></div>
    <div class="row">
      <div class="col-sm-3">
        <div class="input-group">
          <span class="input-group-addon" id="search-addon"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></span>
          <input id="search-term-input" type="text" class="form-control" placeholder="Search" aria-describedby="search-addon">
        </div>
      </div>
      <div class="col-sm-2">
        <custom-select name="environment" selected.bind="defaultEnvironment" options.bind="environmentOptions" change.delegate="changeEnvironment($event)"></custom-select>
      </div>
      <div class="col-sm-2">
        <custom-select name="project" selected.bind="defaultProject" options.bind="projectOptions" change.delegate="changeProject($event)"></custom-select>
      </div>
      <div class="col-sm-2">
        <custom-select name="host" selected.bind="defaultHost" options.bind="hostOptions" change.delegate="changeHost($event)"></custom-select>
      </div>
      <div class="col-sm-3">
        <button id="openCreateMachineButton" type="button" class="btn bg-purple btn-flat pull-right" click.delegate="showCreateMachineModal()">
          <span class="button-text">Create a new machine</span>
          <span class="fa fa-fw fa-server"></span>
        </button>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12"><br></div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <div class="panel panel-default">
          <table class="table">
            <thead>
            <tr>
              <th>Name</th>
              <th>Project</th>
              <th>Hosts</th>
              <th>Path</th>
              <th>Git Reference</th>
              <th>Environment</th>
              <th></th>
            </tr>
            </thead>
            <tbody>
            <tr repeat.for="instance of instances" class="instance-result">
              <td class="instance-result-cell instance-result-name"><a href="instances/${instance.id}">${instance.name}</a></td>
              <td class="instance-result-cell instance-result-project">${instance.project.name}</td>
              <td class="instance-result-cell instance-result-host">${instance.host.name}</td>
              <td class="instance-result-cell instance-result-path">${instance.path}</td>
              <td class="instance-result-cell instance-result-git">${instance.git_reference}</td>
              <td class="instance-result-cell instance-result-environment">${instance.environment}</td>
              <td></td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Create new machine modal-->
  <modal id="machine-modal">
    <modal-header title="Edit Person"></modal-header>
    <modal-body   id="machine-modal" content="views/add-machine/add-machine"></modal-body>
    <modal-footer id="machine-modal" buttons.bind="[{label:'Cancel',class:'btn-link', id:'machine-modal-cancel'},{label:'Save', class:'btn-primary', id:'machine-modal-save'}]"></modal-footer>
  </modal>

</template>
